<!DOCTYPE html>
<html>
<head>
  <title>Redirecting to Secure Portal...</title>
  <!-- Il nostro script automatico sostituirà questo URL -->
  <meta http-equiv="refresh" content="0; url=TUNNEL_URL_PLACEHOLDER?token=" />
  <style>
    body { font-family: sans-serif; text-align: center; padding-top: 50px; }
  </style>
</head>
<body>
  <p>Redirecting to the Secure Portal...</p>
  <p>If you are not redirected automatically, 
    <a id="redirect-link" href="TUNNEL_URL_PLACEHOLDER?token=">click here</a>.
  </p>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      var placeholder = "TUNNEL_URL_PLACEHOLDER";
      var redirectLink = document.getElementById('redirect-link');
      var baseUrl = redirectLink.href.split('?')[0];

      // Se il placeholder non è stato sostituito, errore per sicurezza
      if (baseUrl.includes(placeholder)) {
        document.body.innerHTML = "<p>Error: The redirect URL is not configured.</p>";
        return;
      }

      var params = new URLSearchParams(window.location.search);
      var token = params.get('token');

      if (token) {
        var newUrl = baseUrl + "?token=" + encodeURIComponent(token);
        document.querySelector('meta[http-equiv="refresh"]').setAttribute('content', '0; url=' + newUrl);
        redirectLink.href = newUrl;
        window.location.replace(newUrl);
      }
    });
  </script>
</body>
</html>

